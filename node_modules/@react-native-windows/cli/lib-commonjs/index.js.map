{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Microsoft Corporation.\n * Licensed under the MIT License.\n * @format\n */\n\nimport fs from 'fs';\nimport path from 'path';\nimport {Telemetry} from '@react-native-windows/telemetry';\n\nimport {\n  copyProjectTemplateAndReplace,\n  installScriptsAndDependencies,\n} from './generator-windows';\n\nimport {autoLinkCommand} from './runWindows/utils/autolink';\nimport {runWindowsCommand} from './runWindows/runWindows';\nimport {dependencyConfigWindows} from './config/dependencyConfig';\nimport {projectConfigWindows} from './config/projectConfig';\n\n/**\n * Project generation options\n *\n *      _\n *     | |\n *   __| | __ _ _ __   __ _  ___ _ __\n *  / _` |/ _` | '_ \\ / _` |/ _ \\ '__|\n * | (_| | (_| | | | | (_| |  __/ |\n *  \\__,_|\\__,_|_| |_|\\__, |\\___|_|\n *                     __/ |\n *                    |___/\n *\n *\n * Properties on this interface must remain stable, as new versions of\n * react-native-windows-init may be used with local-cli dating back to 0.61.\n * All existing arguments must work correctly when changing this interface.\n */\nexport interface GenerateOptions {\n  overwrite: boolean;\n  language: 'cpp' | 'cs';\n  projectType: 'app' | 'lib';\n  experimentalNuGetDependency: boolean;\n  nuGetTestVersion?: string;\n  nuGetTestFeed?: string;\n  useWinUI3: boolean;\n  useHermes: boolean;\n  useDevMode: boolean;\n  verbose: boolean;\n  telemetry: boolean;\n}\n\nfunction scrubOptions(opt: GenerateOptions) {\n  return {\n    overwrite: opt.overwrite,\n    language: opt.language,\n    projectType: opt.projectType,\n    experimentalNuGetDependency: opt.experimentalNuGetDependency,\n    nuGetTestFeed: opt.nuGetTestFeed !== undefined ? true : false,\n    nuGetTestVersion: opt.nuGetTestVersion !== undefined ? true : false,\n    useWinUI3: opt.useWinUI3,\n    useHermes: opt.useHermes,\n    verbose: opt.verbose,\n  };\n}\n\n/**\n * Simple utility for running the Windows generator.\n *\n * @param  projectDir root project directory (i.e. contains index.js)\n * @param  name       name of the root JS module for this app\n * @param  ns         namespace for the project\n * @param  options    command line options container\n */\nexport async function generateWindows(\n  projectDir: string,\n  name: string,\n  ns: string,\n  options: GenerateOptions,\n) {\n  let error;\n  try {\n    if (!fs.existsSync(projectDir)) {\n      fs.mkdirSync(projectDir);\n    }\n\n    await installScriptsAndDependencies(options);\n\n    const rnwPackage = path.dirname(\n      require.resolve('react-native-windows/package.json', {\n        paths: [projectDir],\n      }),\n    );\n    const templateRoot = path.join(rnwPackage, 'template');\n    await copyProjectTemplateAndReplace(\n      templateRoot,\n      projectDir,\n      name,\n      ns,\n      options,\n    );\n  } catch (e) {\n    error = e;\n    Telemetry.trackException(error);\n    throw e;\n  } finally {\n    if (Telemetry.client) {\n      let rnVersion = '';\n      let cliVersion = '';\n      try {\n        const cwd = process.cwd();\n        const rnwPkg = JSON.parse(\n          fs\n            .readFileSync(\n              require.resolve('react-native-windows/package.json', {\n                paths: [cwd],\n              }),\n            )\n            .toString(),\n        );\n        rnVersion = rnwPkg.peerDependencies['react-native'] || '';\n        const rnwCliPkgJson = require('../package.json');\n        cliVersion = rnwCliPkgJson.version;\n      } catch {}\n      const optScrubbed = scrubOptions(options);\n      Telemetry.client.trackEvent({\n        name: 'generate-windows',\n        properties: {\n          error: error,\n          ...optScrubbed,\n          'react-native': rnVersion,\n          'cli-version': cliVersion,\n        },\n      });\n\n      Telemetry.client.flush();\n    }\n  }\n}\n\n// Assert the interface here doesn't change for the reasons above\nconst assertStableInterface: typeof generateWindows extends (\n  projectDir: string,\n  name: string,\n  ns: string,\n  options: GenerateOptions,\n) => Promise<void>\n  ? true\n  : never = true;\nassertStableInterface;\n\nexport const commands = [autoLinkCommand, runWindowsCommand];\nexport const dependencyConfig = dependencyConfigWindows;\nexport const projectConfig = projectConfigWindows;\nexport * from './healthChecks';\n"]}